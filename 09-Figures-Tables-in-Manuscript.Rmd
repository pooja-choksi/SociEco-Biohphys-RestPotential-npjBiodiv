---
title: "People-centric restoration: Figures and tables in manuscript"
author: "Pooja Choksi"
date: '2022-06-27'
output: html_document
---

In this script, we use the district level land use, multidimensional poverty, climate vulnerability and population data along with new sources of data for question 4 of this study.  


```{r setup, include=FALSE}
library(ggplot2)
library(forcats)
library(dplyr)
library(qcc)
library(gridExtra)
library(viridis)
#get color blind friendly colors 
library(pals)

```


Read in all the data from previous scripts that we need for plots and tables.

```{r message = FALSE, warning=FALSE, include=TRUE}

#For all questions, we need this data
districts_info = read.csv("District-Climate-MPI-Biophys-Ranked.csv")

```

## SYNERGIES AND TRADE-OFFS BETWEEN SEVERAL FACTORS

The chunk of code below creates a scatterplot where each district's biophysical potential rank and people-centric restoration opportunity rank is plotted. 

We also subset the data into the different quantiles to have a closer look at which districts are in the top and bottom quantiles and how that compares to their biophysical potential.

```{r message=FALSE, warning=FALSE, include=TRUE, echo= FALSE}

#All the land tenures together
#first categorize the three variables

#Remove the duplicate in Assam, so we will have only 562 districts 
districts_info = districts_info [!duplicated(districts_info[c("NAME_1","NAME_2")]),]

districts_info$tenure_max  = apply(districts_info[c("Ttl_In_", "Ttl_Cm_", "Ttl_Fr_")], 1, max)

districts_info = districts_info%>%mutate(tenure_max_cat = 
 case_when(tenure_max == Ttl_In_ ~ "Individual",
           tenure_max == Ttl_Cm_ ~ "Common",
           tenure_max == Ttl_Fr_ ~ "Forest", 
           TRUE ~ "NA"))

biophys_people_scale = ggplot(districts_info) + geom_jitter(data= districts_info, aes(x = strass_rank, y= Cmbnd_R, shape = tenure_max_cat, color = Clmt_v_, size = Lvng_st), alpha = 0.6)+ theme_bw()+scale_color_viridis(option = "D")+
  scale_y_continuous(name = "District rank according to people-centric restoration opportunity") + scale_x_continuous(name="District rank according to biophysical restoration potential")+ 
   geom_vline(xintercept =280.1068, linetype="dashed") + geom_hline(yintercept = 124.1441, linetype="dashed")+ labs(color = "Climate Vulnerability", size = "Poverty %", shape = "Dominant tenure regime")

biophys_people_scale

#report the synergies and trade-offs
#Biophysical factors v/s people-centric factors 
#split the data into 4 equal parts 
summary(districts_info$Cmbnd_R)

districts_info = districts_info%>%mutate(People_Cat = case_when(
  Cmbnd_R<=69.0 ~ "High", #under first quantile
  Cmbnd_R>=69.0 & Cmbnd_R<119.0 ~ "Medium", #between first quantile and median
  Cmbnd_R>=119.0 & Cmbnd_R<178.8 ~ "Low", #between median and third quantile
  Cmbnd_R>=178.8 & Cmbnd_R< 300 ~"Very low",
  TRUE~ "NA"))

summary(districts_info$strass_rank)

districts_info = districts_info%>%mutate(Strass_Cat = case_when(
  strass_rank<=140.2 ~ "High",
  strass_rank>=140.2 & strass_rank<280.1 ~ "Medium",
  strass_rank>=280.1 & strass_rank<419.8 ~ "Low",
  strass_rank>=419.8 & strass_rank<560 ~"Very low",
  TRUE~ "NA"))

high_both = districts_info%>%filter(Strass_Cat == "High" & People_Cat == "High")

very_low = districts_info%>%filter(Strass_Cat == "Very low" & People_Cat == "High")

low = districts_info%>%filter(Strass_Cat == "Low" & People_Cat == "High")

#Which states are the high -high potential districts in?
high_states = high_both%>%group_by(NAME_1)%>%count()


#Districts above and below the mean (to match the scatterplot)

#high people-high biophysical
ppl_bio_high = districts_info%>%filter(strass_rank<=280.1  & Cmbnd_R<= 124.1)

ppl_high_bio_low = districts_info%>%filter(strass_rank>=280.1  & Cmbnd_R<= 124.1)

ppl_low_bio_high = districts_info%>%filter(strass_rank<=280.1  & Cmbnd_R>= 124.1)

ppl_bio_low = districts_info%>%filter(strass_rank>=280.1  & Cmbnd_R>= 124.1)

```

## CHARACTERISTICS OF POPULATION IN HIGH PEOPLE_CENTRIC RESTORATION OPPORTUNITY AREAS

1. Number of land-owning and landless households in the district.

```{r pressure, echo=FALSE, message=FALSE, warning=FALSE, include=TRUE}
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
